name: Language Compliance Check

"on":
  pull_request:
    paths:
      - '**.md'
      - '**.yml'
      - '**.yaml'
      - 'docs/**'

permissions:
  contents: read
  pull-requests: write
  issues: write

jobs:
  language-check:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # v4.2.2

      - name: ğŸŸ¢ Setup Node.js
        uses: actions/setup-node@39370e3970a6d050c480ffad4ff0ed4d3fdee5af # v4.1.0
        with:
          node-version: '18'

      - name: ğŸ” Check language compliance
        run: |
          chmod +x scripts/naming/language-checker.mjs
          node scripts/naming/language-checker.mjs .

      - name: ğŸ“Š Generate report
        if: always()
        run: |
          echo "## ğŸŒ èªè¨€åˆè¦æ€§æª¢æŸ¥å ±å‘Š" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "âœ… èªè¨€æª¢æŸ¥å·²åŸ·è¡Œ" >> $GITHUB_STEP_SUMMARY
  
  # ==================== äº’å‹•å¼å®¢æœæ•´åˆ ====================
  # Note: å…¨æ™‚åé¥‹å‹ - åœ¨æ‰€æœ‰äº‹ä»¶éƒ½æä¾›äº’å‹•å¼åé¥‹
  interactive-service:
    name: ğŸ¤– Language Check äº’å‹•å¼å®¢æœ
    needs: [language-check]
    if: always()
    uses: ./.github/workflows/interactive-ci-service.yml
    with:
      ci-name: "Language Compliance Check"
      ci-status: ${{ needs.language-check.result }}
      ci-context: |
        {
          "check_result": "${{ needs.language-check.result }}"
        }
      error-logs: ${{ needs.language-check.result == 'failure' && 'èªè¨€åˆè¦æ€§æª¢æŸ¥å¤±æ•—ã€‚è«‹ç¢ºä¿ï¼š\n1. .md/.yml æª”æ¡ˆä½¿ç”¨ç¹é«”ä¸­æ–‡\n2. æ’é™¤ç›®éŒ„è¨­å®šæ­£ç¢º\n3. æŸ¥çœ‹è©³ç´°éŒ¯èª¤è¨Šæ¯ä»¥äº†è§£å“ªäº›æª”æ¡ˆä¸ç¬¦è¦ç¯„' || '' }}
    permissions:
      contents: read
      pull-requests: write
      issues: write
