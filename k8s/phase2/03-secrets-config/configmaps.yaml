# ============================================================================
# 配置映射
# ============================================================================

apiVersion: v1
kind: ConfigMap
metadata:
  name: autofix-config
  namespace: autofix
  labels:
    app: autofix
data:
  # 應用配置
  LOG_LEVEL: "INFO"
  ENVIRONMENT: "production"
  ENABLE_PROFILING: "false"
  ENABLE_DEBUG: "false"
  
  # 服務配置
  API_HOST: "0.0.0.0"
  API_PORT: "8000"
  METRICS_PORT: "9090"
  HEALTH_CHECK_INTERVAL: "30"
  
  # 數據庫配置
  DATABASE_HOST: "postgres"
  DATABASE_PORT: "5432"
  DATABASE_NAME: "autofix"
  DATABASE_POOL_SIZE: "20"
  DATABASE_MAX_OVERFLOW: "40"
  DATABASE_POOL_RECYCLE: "3600"
  DATABASE_ECHO: "false"
  
  # Redis 配置
  REDIS_HOST: "redis"
  REDIS_PORT: "6379"
  REDIS_DB: "0"
  REDIS_POOL_SIZE: "10"
  REDIS_SOCKET_TIMEOUT: "5"
  REDIS_SOCKET_CONNECT_TIMEOUT: "5"
  
  # 分析配置
  ANALYSIS_TIMEOUT: "300"
  ANALYSIS_MAX_WORKERS: "8"
  ANALYSIS_CACHE_TTL: "3600"
  ANALYSIS_BATCH_SIZE: "100"
  
  # 修復配置
  REPAIR_TIMEOUT: "120"
  REPAIR_MAX_ATTEMPTS: "3"
  REPAIR_AUTO_APPLY: "false"
  REPAIR_CONFIDENCE_THRESHOLD: "0.8"
  
  # 監控配置
  METRICS_ENABLED: "true"
  TRACING_ENABLED: "true"
  TRACING_SAMPLE_RATE: "0.1"
  
  # 通知配置
  NOTIFICATION_ENABLED: "true"
  SLACK_ENABLED: "true"
  EMAIL_ENABLED: "true"
  WEBHOOK_ENABLED: "true"
  
  # 安全配置
  ENABLE_CORS: "true"
  CORS_ORIGINS: "https://autofix.example.com,https://dashboard.autofix.example.com"
  ENABLE_RATE_LIMITING: "true"
  RATE_LIMIT_REQUESTS: "1000"
  RATE_LIMIT_PERIOD: "60"

---
# 開發環境配置
apiVersion: v1
kind: ConfigMap
metadata:
  name: autofix-config-dev
  namespace: autofix-dev
data:
  LOG_LEVEL: "DEBUG"
  ENVIRONMENT: "development"
  ENABLE_PROFILING: "true"
  ENABLE_DEBUG: "true"
  DATABASE_POOL_SIZE: "5"
  ANALYSIS_CACHE_TTL: "60"
  REPAIR_AUTO_APPLY: "true"
  ENABLE_RATE_LIMITING: "false"
